# Four-Way Handshake, key hierarchy

![image.png](<../.gitbook/assets/image (3) (1) (1).png>)

**ANonce** → refer to Access point Number Only Used Once - which generate randomly by hardware

**SNonce** → Station nonce

**MIC** → refer to Message integrity Check

**GTK** → Group Temporary Key

> <mark style="color:green;">**PTK → refer to type of encryption used**</mark>

<figure><img src="../.gitbook/assets/image 1 (2) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

<mark style="color:green;">**we use name and pass to generate PSK/PMK after add ANONCE/SNONCE we generate PTK**</mark>

<figure><img src="../.gitbook/assets/image 2 (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

$$
PSK→ Pre Shared Key
$$
